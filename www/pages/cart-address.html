<template>
<div class="page page-cart-address" data-name="cart-address">
    <div class="navbar ">
        <div class="navbar-bg"></div>
        <div class="navbar-inner">
            <div class="left  no-margin-right">
                <a href="#" class="link icon-only panel-open " data-panel="left">
                    <i class="icon f7-icons size-22">bars</i>
                </a>
            </div>
            <div class="title text-align-center">
                <div class="logo-small">
                    <img src="img/logo.png" alt="" class="img" />
                    <!-- <h6>GO<br /><small>MobileUX</small></h6> -->
                </div>
            </div>
            <div class="right text-align-center">
                <a href="/notificationlist/" class="link">
                    <i class="icon f7-icons size-22">bell_fill</i>
                </a>
            </div>
        </div>
    </div>


    <!-- main page content -->
    <div class="page-content has-footer">

        <!-- wizard links -->
        <div class="block">
            <div class="row justify-content-between wizard-wrapper margin-bottom elevation-2  top-20">
                <div class="col-33">
                    <a href="/cart/" class="wizard-link filled">
                        <i class="icons f7-icons elevation-2">bag</i>
                        <span class="wizard-text">Products</span>
                    </a>
                </div>
                <div class="col-33">
                    <a href="/address/" class="wizard-link active">
                        <i class="icons f7-icons elevation-2">placemark</i>
                        <span class="wizard-text">Address</span>
                    </a>
                </div>
                <div class="col-33">
                    <a href="/payment/" class="wizard-link">
                        <i class="icons f7-icons elevation-2">creditcard</i>
                        <span class="wizard-text">Payment</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- cart items -->
        <div class="block">
            <div class="row margin-bottom-half">
                <div class="col align-self-center">
                    <h5 class="no-margin-bottom">Delivery location</h5>
                </div>
                <div class="col-auto pe-0 align-self-center">
                    <a href="/addresses/" class="link text-color-theme">Change <i class="icons f7-icons">chevron_right</i></a>
                </div>
            </div>
        </div>

        <div class="block">
            <div class="row">
               
                
                <div class="col-100 medium-50">
                    <div class="card elevation-2 product margin-bottom-half">
                        <div class="card-header">
                           <!-- for default address  -->
                            
                                <div class="row">
                                    <div class="col-auto align-self-center md">
                                        <!-- <label class="item-radio item-radio-icon-start item-content">
                                            <input type="radio" name="defaultAddress" value="${item.id}" checked />
                                            <i class="icon icon-radio"></i>
                                        </label>   -->

                                    </div>
                                    <div class="col align-self-center no-padding-left">
                                        <h5 class="no-margin-bottom">${item.type}<br/>
                                            <span class="text-opac small">Primary Address</span>
                                        </h5>
                                    </div>
                                    <div class="col-auto align-self-center">
                                        <a href="/editaddress/${item.id}/" class="btn btn-link text-color-theme"><i class="icons f7-icons">square_pencil</i></a>
                                        <!-- <a href="#" class="btn btn-link text-color-theme"><i class="icons f7-icons">trash</i></a> -->
                                    </div>
                                </div> 
                            
                        </div>
                        <div class="card-content card-content-padding">
                            <!-- <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d53231.962811927515!2d-117.15726395005734!3d33.5014375970648!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80db6252f51abe23%3A0x68bc0e88a03806a8!2sTemecula%2C%20CA%2C%20USA!5e0!3m2!1sen!2sin!4v1623665123540!5m2!1sen!2sin"
                                class="h-190 width-100 rounded shadow-sm margin-bottom-half" allowfullscreen="" loading="lazy">
                            </iframe> -->
                            <div class="row">
                                <div class="col">
                                    <div class="addressHeader">
                                        ${item.name} ( ${item.mobile} )
                                    </div>
                                    <div>
                                        ${item.address}, ${item.landmark}, ${item.pin}
                                    </div>
                                   
                                </div>
                                <div class="col-auto align-self-center">
                                    <a  href="#"><i class="icons f7-icons text-color-theme float-right">arrow_up_right_circle</i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    

                </div>



            </div>
        </div>

        <!-- pricing -->
        <div class="block">
            <div class="row margin-bottom-half">
                <div class="col align-self-center">
                    <h5 class="no-margin-bottom">Pricing</h5>
                </div>
            </div>
            <div class="row margin-bottom-half">
                <div class="col">
                    <p>Shipping Cost</p>
                </div>
                <div class="col-auto">₹ ${shippingCost}</div>
            </div>

            <div class="row margin-bottom-half">
                <div class="col">
                    <p>Subtotal</p>
                </div>
                <div class="col-auto">₹ ${subtotal}</div>
            </div>

            <div class="row font-weight-bold margin-bottom">
                <div class="margin-bottom-half col-100">
                    <div class="dashed-line"></div>
                </div>
                <div class="col">
                    <p>Total</p>
                </div>
                <div class="col-auto">₹ ${total}</div>
            </div>
        </div>

        <!-- Button -->
        <div class="block">
            <div class="row margin-bottom">
                <div class="col align-self-center">
                    <a href="/payment/" class="button button-large button-fill elevation-3 color-green">Next</a>
                </div>
            </div>
        </div>

    </div>

    <!-- footer static -->
    <footer class="footer">
        <div class="container">
            <ul>
                <li>
                    <a href="/home/">
                        <span>
                            <i class="icon f7-icons">house</i>
                            <span class="nav-text">Home</span>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="/stats/">
                        <span>
                            <i class="icon f7-icons">chart_bar</i>
                            <span class="nav-text">Stats</span>
                        </span>
                    </a>
                </li>
                <li class="active center-item">
                    <a href="/cart/">
                        <span>
                            <i class="icon f7-icons">cart</i>
                            <span class="nav-text">card-content</span>
                            <span class="countercart">3</span>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="/style/">
                        <span>
                            <i class="icon f7-icons">circle_grid_hex</i>
                            <span class="nav-text">Style</span>
                        </span>
                    </a>
                </li>
                <li>
                    <a href="/settings/">
                        <span>
                            <i class="icon f7-icons">gear</i>
                            <span class="nav-text">Settings</span>
                        </span>
                    </a>
                </li>
            </ul>
        </div>
    </footer>

</div>
</template>
<script>
    export default (props, { $f7, $theme, $on, $update, $ }) => {
      var app = $f7;
      let cartList = [] ;
      let item = {
        "address": "",
        "id":"",
        "landmark": "",
        "mobile": "",
        "name": "",
        "pin": "",
        "type": ""
      };  
        let totalQuantity =  0;
        let total = 0;
        let subtotal = 0;
        // let cartCount = app.params.cartCount();
        let cartCount = 0;
        let shippingCost = 0;
        const pageId = app.params.uuid();
      
        let removeCurrentProduct = (pid)=>{
            $f7.preloader.show();
             //=======remove cart items from server =======
            app.params.callToServer( "remove-cart", {'pid':pid} ,
            function success(Responce){
                $f7.preloader.hide();
                updateCurrentCart(Responce);
                // categoryName = Responce.data.category;
            });
        }

        const updateCurrentCart = (Responce)=>{
                cartList = Responce.cartContent ;
                totalQuantity = Responce.totalQuantity;
                total = Responce.total;
                subtotal = Responce.subtotal;
                cartCount = Responce.cartCount;
                shippingCost =  Responce.shippingCost;
                $update();
        }

        $on('pageBeforeIn', () => {
            $f7.preloader.show();
            app.params.callToServer( "cart-address",'',success);
            function success(ResponceData){
                $f7.preloader.hide();

                updateCurrentCart(ResponceData.data.cartDetails);
                item = ResponceData.data.defaultAddress[0];
                $update();
            }





        });
  
      return $render;
    }
  </script>